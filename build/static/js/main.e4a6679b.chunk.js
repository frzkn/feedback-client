(this["webpackJsonpfeedback-system"]=this["webpackJsonpfeedback-system"]||[]).push([[0],{39:function(e,t,a){e.exports=a(72)},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},72:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(14),l=a.n(r),o=(a(44),a(45),a(3)),s=a(8),m=(a(46),function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement("ul",{className:"flex p-4 shadow mb-8"},c.a.createElement("h1",{className:"flex font-bold items-center"},c.a.createElement("svg",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",className:"w-6 h-6 mr-2"},c.a.createElement("path",{d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})),c.a.createElement("span",null,"Feedback Portal")),c.a.createElement("li",{className:" ml-auto mr-2 md:mr-6"},c.a.createElement(o.c,{className:"text-teal-500 hover:text-teal-800",exact:!0,to:"/"},c.a.createElement("svg",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",className:"w-6 h-6"},c.a.createElement("path",{d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})))),c.a.createElement("li",{className:"  mr-2 md:mr-6"},c.a.createElement(o.c,{className:"text-teal-500 hover:text-teal-800",exact:!0,to:"/newpost"},c.a.createElement("svg",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",className:"w-6 h-6"},c.a.createElement("path",{d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})))),c.a.createElement("li",{className:"  mr-2 md:mr-6"},c.a.createElement(o.c,{className:"text-teal-500 hover:text-teal-800",exact:!0,to:"/login"},c.a.createElement("svg",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",className:"w-6 h-6"},c.a.createElement("path",{d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"}))))))}),u=a(9),i=a.n(u),d=a(33),p=a.n(d);var f={setToken:function(e,t){localStorage.setItem("jwt",e),localStorage.setItem("user",t)},getToken:function(){return localStorage.getItem("jwt")},logout:function(){localStorage.removeItem("jwt"),localStorage.removeItem("user")},isTokenExpired:function(e){try{return p()(e).exp<Date.now()/1e3}catch(t){console.log(t)}},loggedIn:function(){var e=this.getToken();return!this.isTokenExpired(e)&&!!e},getUser:function(){return localStorage.getItem("user")}},E=function(e){return{headers:{Authorization:e}}},b=function(e){return function(t){i.a.post("/api/post",e,E(f.getToken())).then((function(e){t({type:"POST_SUCCESS"})}))}},h=a(1),g=function(){var e=Object(h.c)((function(e){return e.postReducer})),t=Object(s.f)(),a=Object(h.b)();return Object(n.useEffect)((function(){a((function(e){i.a.get("/api/post",E(f.getToken())).then((function(t){return e({type:"FETCH_SUCCESS",payload:t.data})})).catch((function(t){return e({type:"FETCH_FAILED",error:t.error})}))}))}),[]),Object(n.useEffect)((function(){f.loggedIn()||t.push("/login")}),[]),c.a.createElement("div",{className:"container p-4 md:max-w-xl mx-auto flex flex-col"},c.a.createElement("h1",{className:"text-2xl mb-4 text-center"},"All Feedbacks"),c.a.createElement("div",{className:"grid md:grid md:grid-cols-2 gap-4 "},e.data.length>0&&e.data?e.data.map((function(e){return c.a.createElement("div",{className:"flex pt-4 shadow border flex-col bg-teal-500",key:e._id},c.a.createElement("h2",{className:"text-xl px-4  text-white font-bold"},e.title.length>20?e.title.slice(0,20)+"...":e.title),c.a.createElement("p",{className:"px-4 text-white"},"@",e.username),c.a.createElement("p",{className:"p-2 flex-grow bg-teal-600 m-4 rounded text-white"},e.content.length>45?e.content.slice(0,45)+"...":e.content),c.a.createElement(o.b,{to:"/post/".concat(e._id)},c.a.createElement("div",{className:" bg-white text-center border-t mt-2 pt-3 pb-3 cursor-pointer hover:bg-gray-200 flex justify-center items-center"}," ",c.a.createElement("span",null,"Comments"),c.a.createElement("svg",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",class:"w-4 h-4 ml-4"},c.a.createElement("path",{d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})))))})):c.a.createElement("h1",{className:" block md:col-span-2 text-center p-16 text-1xl"},"No feedbacks to show")))},x=a(22),v=a.n(x),N=a(35),w=a(2),O=function(){var e=Object(n.useState)(""),t=Object(w.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)(""),o=Object(w.a)(l,2),m=o[0],u=o[1],i=Object(h.b)(),d=Object(s.f)();Object(n.useEffect)((function(){f.loggedIn()||d.push("/")}),[]);var p=function(){var e=Object(N.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a&&m&&(i(b({title:a,content:m})),r(""),u(""),alert("Thank you for your feedback"),d.push("/"));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return c.a.createElement("div",{className:"container p-4 md:max-w-xl mx-auto flex flex-col"},c.a.createElement("h1",{className:"text-center text-2xl"},"Create a new post"),c.a.createElement("form",{onSubmit:p},c.a.createElement("label",{className:"block mb-4"},c.a.createElement("span",{className:"text-gray-700"},"Title"),c.a.createElement("input",{type:"text",className:"form-input mt-1 block w-full",placeholder:"Give a title to your feedback",value:a,onChange:function(e){return r(e.target.value)},required:!0})),c.a.createElement("label",{className:"block mb-4"},c.a.createElement("span",{className:"text-gray-700"},"Feedback"),c.a.createElement("textarea",{className:"form-textarea mt-1 block w-full",rows:"3",placeholder:"Please describe your experience",value:m,onChange:function(e){return u(e.target.value)},required:!0})),c.a.createElement("button",{type:"submit",className:"bg-teal-400 inline-block w-24 text-white  py-2 rounded shadow "},"Submit")))},k=function(){var e=Object(n.useState)(""),t=Object(w.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)(""),m=Object(w.a)(l,2),u=m[0],d=m[1],p=Object(h.b)(),E=(Object(h.c)((function(e){return e.authReducer})),Object(s.f)()),b=f.getUser();return Object(n.useEffect)((function(){b&&f.loggedIn()&&(window.confirm("Do you want to end this session?")?(f.logout(),p({type:"LOGOUT"})):E.push("/"))}),[]),c.a.createElement("div",{className:"p-4"},c.a.createElement("h1",{className:"text-2xl mb-4 text-center"},"Please login to continue"),c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),a.trim()&&u.trim()?(p(function(e){return function(t){i.a.post("/api/login",e).then((function(e){return e.data})).then((function(a){a.success&&(f.setToken(a.token,e.username),t({type:"LOGIN_SUCCESS",payload:e}))})).catch((function(e){alert("Error in login"),console.log("Login Error",e)}))}}({username:a,password:u})),setTimeout((function(){E.push("/")}),1e3)):alert("Validation Error")}},c.a.createElement("div",{className:"container p-4 md:max-w-xl\t mx-auto flex flex-col"},c.a.createElement("label",{className:"block mb-4"},c.a.createElement("span",{className:"text-gray-700"},"Username"),c.a.createElement("input",{type:"text",className:"form-input mt-1 block w-full",placeholder:"faraz@example.com",value:a,onChange:function(e){return r(e.target.value)}})),c.a.createElement("label",{className:"block mb-4"},c.a.createElement("span",{className:"text-gray-700"},"Password"),c.a.createElement("input",{type:"password",className:"form-input mt-1 block w-full",placeholder:"*********",value:u,onChange:function(e){return d(e.target.value)}})),c.a.createElement("button",{className:"bg-teal-400 inline-block w-24 text-white  py-2 rounded shadow "},"Submit"))),c.a.createElement("p",{className:"text-center "},"Need an account?",c.a.createElement(o.b,{to:"/register"},c.a.createElement("span",{className:"text-blue-600 font-bold cursor-pointer"}," Sign up here"))))},S=function(){var e=Object(n.useState)(""),t=Object(w.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)(""),m=Object(w.a)(l,2),u=m[0],d=m[1],p=Object(n.useState)(""),E=Object(w.a)(p,2),b=E[0],g=E[1],x=Object(s.f)(),v=Object(h.b)();Object(n.useEffect)((function(){f.loggedIn()&&x.push("/")}),[]);return c.a.createElement("div",{className:"p-4"},c.a.createElement("h1",{className:"text-2xl mb-4 text-center"},"Register a new account"),c.a.createElement("form",{onSubmit:function(e){var t;e.preventDefault(),a.trim()&&u.trim()&&b.trim()?v((t={username:u,email:a,password:b},function(e){i.a.post("/api/register",t).then((function(t){e({type:"REGISTER_SUCCESS"}),alert("You have registered please login")})).catch((function(t){e({type:"REGISTER_FAILURE"}),alert("Error in registration")}))})):alert("Validation Error")}},c.a.createElement("div",{className:"container p-4 md:max-w-xl\t mx-auto flex flex-col"},c.a.createElement("label",{className:"block mb-4"},c.a.createElement("span",{className:"text-gray-700"},"Email"),c.a.createElement("input",{type:"email",className:"form-input mt-1 block w-full",placeholder:"faraz@example.com",value:a,onChange:function(e){return r(e.target.value)}})),c.a.createElement("label",{className:"block mb-4"},c.a.createElement("span",{className:"text-gray-700"},"Username"),c.a.createElement("input",{type:"text",className:"form-input mt-1 block w-full",placeholder:"faraz",value:u,onChange:function(e){return d(e.target.value)}})),c.a.createElement("label",{className:"block mb-4"},c.a.createElement("span",{className:"text-gray-700"},"Password"),c.a.createElement("input",{type:"password",className:"form-input mt-1 block w-full",placeholder:"*********",value:b,minlength:"8",onChange:function(e){return g(e.target.value)}})),c.a.createElement("button",{className:"bg-teal-400 inline-block w-24 text-white  py-2 rounded shadow "},"Submit"))),c.a.createElement("p",{className:"text-center "},"Have an account?",c.a.createElement(o.b,{to:"/login"},c.a.createElement("span",{className:"text-blue-600 font-bold cursor-pointer"}," Login here"))))},j=function(e){var t=e.comment,a=e.classes,r=e.reply,l=Object(n.useState)(!1),o=Object(w.a)(l,2),s=o[0],m=o[1],u=Object(n.useState)(""),d=Object(w.a)(u,2),p=d[0],b=d[1];console.log(t);var g=Object(h.b)();r&&console.log("comment is ",t);return c.a.createElement("li",{className:"border-b p-4 ".concat(a," ").concat(r?"bg-gray-100":"bg-gray-200")},c.a.createElement("p",{className:"font-semibold"},t.username),c.a.createElement("div",{className:""},c.a.createElement("p",{className:"col-span-8 md:col-span-9"},t.content),r&&[!s&&c.a.createElement("button",{className:"ml-auto flex px-2 py-2 mt-1 bg-teal-400 rounded text-white text-xs items-center flex-end",onClick:function(){return m(!0)}},c.a.createElement("svg",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",className:"w-4 h-4"},c.a.createElement("path",{d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})),c.a.createElement("span",{className:" ml-2"},"REPLY")),s&&c.a.createElement("div",{className:"flex items-center "},c.a.createElement("form",{onSubmit:function(e){var a;e.preventDefault(),console.log("ran"),p.trim()?(g((a={comment:t._id,content:p},function(e){i.a.post("/api/subcomment",a,E(f.getToken())).then((function(t){e({type:"SUB_COMMENT_SUCCESS",payload:t.data.subComment})}))})),b("")):alert("Please enter a reply")},className:" flex flex-grow"},c.a.createElement("input",{type:"text",className:"form-input mt-1 block w-full rounded-full",placeholder:"Type a reply",value:p,onChange:function(e){return b(e.target.value)},required:!0})),c.a.createElement("button",{className:"text-teal-500 outline-none ml-2",onClick:function(e){e.preventDefault(),b(""),m(!1)}},c.a.createElement("svg",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",className:"w-6 h-6 mx-auto my-auto"},c.a.createElement("path",{d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"}))))]))},y=function(e){var t=e.comments,a=e.id;console.log(a);var r=Object(n.useState)(""),l=Object(w.a)(r,2),o=l[0],s=l[1],m=Object(h.b)();Object(h.c)((function(e){return e.authReducer}));return c.a.createElement("div",{className:"p-4 shadow rounded border "},c.a.createElement("p",null," Comments "),c.a.createElement("form",{className:"mb-4",onSubmit:function(e){var t;console.log("dispatched"),e.preventDefault(),o&&(m((t={post:a,content:o},function(e){i.a.post("/api/comment",t,E(f.getToken())).then((function(t){return e({type:"COMMENT_SUCCESS",payload:t.data.comment})}))})),s(""))}},c.a.createElement("input",{type:"text",className:"form-input mt-1 block w-full",placeholder:"Type a comment",required:!0,value:o,onChange:function(e){return s(e.target.value)}})),c.a.createElement("ul",null,t&&t.map((function(e){return c.a.createElement("div",null,c.a.createElement(j,{comment:e,classes:"border mt-2",reply:!0}),e.subcomments.map((function(e){return c.a.createElement(j,{comment:e,classes:"ml-4 border-l",reply:!1})})))}))))},C=function(e){var t=e.match,a=Object(h.c)((function(e){return e.postReducer})).selected,r=Object(h.b)(),l=Object(s.f)();return Object(n.useEffect)((function(){f.loggedIn()||l.push("/")}),[]),Object(n.useEffect)((function(){var e;r((e=t.params.id,function(t){i.a.get("/api/post/".concat(e),E(f.getToken())).then((function(e){t({type:"FETCH_ONE_SUCCESS",payload:e.data})})).catch((function(e){return t({type:"FETCH_ONE_FAILED",error:e.error})}))})),window.scrollTo(0,0)}),[]),console.log("selected",a),c.a.createElement("div",{className:"container p-4 md:max-w-xl\t mx-auto flex flex-col "},c.a.createElement("div",{className:"card bg-white border rounded p-4 mb-2 bg-teal-500"},c.a.createElement("h1",{className:"text-white text-2xl font-bold mb-4 "},a.title||"..."),c.a.createElement("p",{className:"mb-2 text-white block"},"@",a.username||"..."),c.a.createElement("p",{className:"p-2 bg-teal-600 rounded rounded-lg text-white"},a.content||"...")),c.a.createElement(y,{comments:a.comments,id:a._id}))};var _=function(){return c.a.createElement(o.a,null,c.a.createElement(m,null),c.a.createElement("main",{className:"min-h-screen"},c.a.createElement(s.c,null,c.a.createElement(s.a,{path:"/",exact:!0,component:g}),c.a.createElement(s.a,{path:"/newpost",exact:!0,component:O}),c.a.createElement(s.a,{path:"/login",exact:!0,component:k}),c.a.createElement(s.a,{path:"/register",exact:!0,component:S}),c.a.createElement(s.a,{path:"/post/:id",exact:!0,component:C}))),c.a.createElement("footer",{className:"h-32 border mt-8 shadow"}))},T=a(10),L=a(38),I=a(7),M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{data:[],loading:!1,selected:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_SUCCESS":var a=Object(I.a)({},e,{loading:!1,data:Object(L.a)(t.payload)});return a;case"FETCH_FAILED":case"FETCH_ONE_FAILED":return e;case"FETCH_ONE_SUCCESS":var n=Object(I.a)({},e,{selected:t.payload});return n;case"COMMENT_SUCCESS":var c=t.payload;console.log("comment is",c);var r=Object(I.a)({},e,{selected:Object(I.a)({},e.selected,{comments:e.selected.comments.concat(c)})});return r;case"SUB_COMMENT_SUCCESS":var l=t.payload;console.log("PAYLOAD"),console.log(t.payload);var o=l.comment,s=e.selected.comments.map((function(e){return e._id===o?Object(I.a)({},e,{subcomments:e.subcomments.concat(l)}):e}));return Object(I.a)({},e,{selected:Object(I.a)({},e.selected,{comments:s})});case"LOGOUT":return{data:[],loading:!1,selected:{}};default:return e}},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{user:{},isLoggedIn:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_SUCCESS":return Object(I.a)({},e,{user:t.payload,isLoggedIn:!0});default:return e}},D=Object(T.c)({authReducer:U,postReducer:M}),F=a(36),R=a.n(F),H=a(37),z=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),A=Object(T.d)(D,Object(T.a)(H.a,R.a),z);l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(h.a,{store:A},c.a.createElement(_,null))),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.e4a6679b.chunk.js.map